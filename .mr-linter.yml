rules:
  "@mr-linter/has_any_labels_of":
    labels:
      - Feature
      - Bug
      - Docs
      - Tests
      - Optimization

  "@mr-linter/title_must_starts_with_any_prefix":
    prefixes:
      - '[Feature]'
      - '[Bug]'
      - '[Docs]'
      - '[Tests]'
      - '[Optimization]'

  "@mr-linter/description_not_empty": {}

  "@mr-linter/has_changes":
    - changes:
      - file: "src/Version.php"
        updatedPhpConstant: "VERSION"
      when:
        targetBranch:
          equals: "master"
        title:
          notStarts: '[Docs]'

    - changes:
        - file: "CHANGELOG.MD"
      when:
        targetBranch:
          equals: "master"
        title:
          notStarts: '[Docs]'

  custom:
    - definition: "Branch must be in kebab-case"
      rules:
        sourceBranch:
          isKebabCase: true

    - definition: "Labels must be in StudlyCase"
      rules:
        labels:
          $all:
            isStudlyCase: true

    - definition: "Description must have list of fixed bugs"
      rules:
        descriptionMarkdown:
          containsHeading2: "Fixed"
      when:
        labels:
          has: "Bug"

    - definition: "Description must have list of features"
      rules:
        descriptionMarkdown:
          containsHeading2: "Added"
      when:
        labels:
          has: "Feature"

notifications:
  channels:
    dev:
      type: 'telegram_bot'
      chat_id: 'env(MR_LINTER_TELEGRAM_CHAT_ID)'
      bot_token: 'env(MR_LINTER_TELEGRAM_BOT_TOKEN)'
  on:
    lint_finished:
      channel: 'dev'
      when:
        result.state:
          equals: false
      template: |
        ðŸ‘€ Review on PR "{{ request.title }}" by {{ request.author.login }} {{ request.createdAt.format('Y-m-d') }}
        
        Notes:
        
        {% for note in result.notes %}
        - {{ note.description }}
        {% endfor %}

credentials:
  github_actions: "env(MR_LINTER_GITHUB_HTTP_TOKEN)"
